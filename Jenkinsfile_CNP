#!groovy
properties(
        [[$class: 'GithubProjectProperty', projectUrlStr: 'https://github.com/hmcts/track-your-appeal-frontend'],
         pipelineTriggers([[$class: 'GitHubPushTrigger']])]
)

@Library("Infrastructure")

def product = "sscs-tya"
def component = "frontend"

withPipeline("nodejs", product, component) {
  after("functionalTest:dev") {
      stage('Access URL') {
        echo "'$env.TEST_URL'"
        AppUrl = $env.TEST_URL
        AppUrl = AppUrl.replace("https", "http")
        println AppUrl.replace("-staging.", ".")
      }
  }

  after("smoketest:dev") {
      stage('Access URL 2') {
        echo "'$env.TEST_URL'"
        AppUrl = $env.TEST_URL
        AppUrl = AppUrl.replace("https", "http")
        println AppUrl.replace("-staging.", ".")
      }
  }

  after("smoketest") {
      stage('Access 3') {
        echo "'$env.TEST_URL'"
        AppUrl = $env.TEST_URL
        AppUrl = AppUrl.replace("https", "http")
        println AppUrl.replace("-staging.", ".")
      }
  }

  after("smoketest:dev") {
      stage('Access URL U') {
        echo "'$env.TEST_URL'"
      }
  }

  after("smoketest:preview") {
      stage('Access URL X') {
        echo "'$env.TEST_URL'"
      }
  }


  after("smoketest:prod") {
      stage('Access URL Z') {
        echo "'$env.TEST_URL'"
      }
  }


}
