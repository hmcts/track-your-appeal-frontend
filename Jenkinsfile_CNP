#!groovy
properties(
        [[$class: 'GithubProjectProperty', projectUrlStr: 'https://github.com/hmcts/track-your-appeal-frontend'],
         pipelineTriggers([[$class: 'GitHubPushTrigger']])]
)

@Library("Infrastructure")

def product = "sscs-tya"
def component = "frontend"

withPipeline("nodejs", product, component) {
  before("build") {
      stage('Url replace') {
        def App123 = "https://pr-153-sscs-case-loader-preview-staging.service.core-compute-preview.internal".replace("https", "http")
        App123 = App123.replace("-staging.", ".")
        println "Frontend URL: " + App123
        println "Health URL: " + App123 + "/health"
        println "Kudu URL: " + App123.replace(".service.", ".scm.service.")
      }
  }


  after("functionalTest:preview") {
      stage('Access URL') {
        echo "'$env.TEST_URL'"
      }
  }

  after("smoketest:preview") {
      stage('Access URL X') {
        def AppUr2 = env.TEST_URL 
        println AppUr2.replace("-staging.", ".")
      }
  }




}
